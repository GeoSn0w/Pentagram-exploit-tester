//
//  ViewController.m
//  Pentagram
//
//  Created by GeoSn0w on 3/18/22.
//

#import "ViewController.h"
#include "Exploit/desc_race.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];

}

- (IBAction)runExploit:(id)sender {
    if (desc_race() == 0){
        UIAlertController *alertvc=[UIAlertController alertControllerWithTitle:@"Exploit seems to work!" message:@"Exploit succeeded, and pipe write also worked. This device on this particular iOS version appears to be compatible with this exploit. Do not update your device! Close the app to reboot now and clean up. If it doesn't reboot by itself, please reboot manually." preferredStyle:UIAlertControllerStyleAlert];
        [self presentViewController: alertvc animated: true completion: nil];
    } else if (desc_race() == -3){
        UIAlertController *alertvc=[UIAlertController alertControllerWithTitle:@"An issue occured." message:@"Exploit failed because pipe leak failed. It's possible the device is running an incompatible iOS version, but still, reboot and try again a few more times. Exploit isn't 100% foolproof." preferredStyle:UIAlertControllerStyleAlert];
        [self presentViewController: alertvc animated: true completion: nil];
    } else if (desc_race() == -1){
        UIAlertController *alertvc=[UIAlertController alertControllerWithTitle:@"An issue occured." message:@"Exploit failed and it seems the device may not be compatible on this version. You can try again after a reboot, but it's possible the device is just not supported." preferredStyle:UIAlertControllerStyleAlert];
        [self presentViewController: alertvc animated: true completion: nil];
    } else if (desc_race() == -1){
        UIAlertController *alertvc=[UIAlertController alertControllerWithTitle:@"An issue occured." message:@"Exploit failed because Pipe Spray failed. It's possible the device is running an incompatible iOS version, but still, reboot and try again a few more times. Exploit isn't 100% foolproof." preferredStyle:UIAlertControllerStyleAlert];
        [self presentViewController: alertvc animated: true completion: nil];
    } else if (desc_race() == 1){
        UIAlertController *alertvc=[UIAlertController alertControllerWithTitle:@"An issue occured." message:@"Exploit failed due to an unhandled error. It's possible the device is running an incompatible iOS version, but still, reboot and try again a few more times. Exploit isn't 100% foolproof." preferredStyle:UIAlertControllerStyleAlert];
        [self presentViewController: alertvc animated: true completion: nil];
    }
}


@end
